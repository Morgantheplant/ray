@import '../../global/mixins/form-items';

.#{$ray-class-prefix}text-field,
.#{$ray-class-prefix}text-area {
  border: $ray-border-width solid $ray-color-gray-60;
  background-color: $ray-color-white;
  border-radius: $ray-border-radius;
  position: relative;
  height: $ray-field-height;

  &__label {
    @include label;
    z-index: 2;
  }

  &__input {
    font-family: inherit;
    border-radius: $ray-border-radius;
    line-height: 1;
    width: 100%;
    height: 100%;
    font-size: $ray-field-label-size;
    display: block;
    background-color: transparent;
    padding: 0 $ray-field-h-spacing;
    outline: 0;
    border: 0;
    cursor: pointer;

    &:focus,
    &:not(:placeholder-shown) {
      + label {
        @include label--active;
      }
    }

    &::placeholder {
      transition: color 0.125s ease-in;
      @include no-select;
    }

    &:not(:focus)::placeholder {
      color: transparent;
    }

    &:focus::placeholder,
    [placeholder] {
      text-overflow: ellipsis;
      color: $ray-color-text-medium;
    }
  }

  [placeholder] {
    text-overflow: ellipsis;
  }

  // :focus-within is only supported in modern browsers (https://caniuse.com/#search=focus-within), --active should be used as a backup
  &--active,
  &:focus-within {
    border-color: $ray-color-blue-50;

    .#{$ray-class-prefix}text-field__label,
    .#{$ray-class-prefix}text-area__label {
      @include label--active;
      color: $ray-color-blue-50;
    }

    .#{$ray-class-prefix}text-field__input,
    .#{$ray-class-prefix}text-area__input {
      &::placeholder {
        color: $ray-color-text-light !important;
      }
    }

    &.#{$ray-class-prefix}text-field--compact,
    &.#{$ray-class-prefix}text-area--compact {
      .#{$ray-class-prefix}text-field__label,
      .#{$ray-class-prefix}text-area__label {
        padding-top: 0;
      }
    }
  }

  &--disabled {
    border-color: rgba($ray-color-gray-60, 0.4);
  }

  &--success {
    border-color: $ray-color-green-70;
  }

  &--error {
    border-color: $ray-color-red-50;
  }

  [disabled] {
    background-color: $ray-color-white;
    @include no-select;

    &,
    + .#{$ray-class-prefix}text-field__label,
    + .#{$ray-class-prefix}text-area__label {
      cursor: not-allowed;
      color: rgba($ray-color-gray-60, 0.4);
    }
  }

  &--compact {
    height: $ray-field-height-compact;

    .#{$ray-class-prefix}text-field__label,
    .#{$ray-class-prefix}text-area__label {
      padding-top: $ray-field-v-spacing-compact;
    }

    .#{$ray-class-prefix}text-field__input,
    .#{$ray-class-prefix}text-area__input {
      padding-top: 0;

      &:focus,
      &:not(:placeholder-shown) {
        + label {
          padding-top: 0;
          pointer-events: none;
        }
      }
    }
  }
}

.#{$ray-class-prefix}text-area {
  line-height: 0;

  &,
  &__input {
    height: auto;
    min-height: $ray-field-height - 2 * $ray-border-width;
  }

  &__input {
    display: inline-block;
    padding-top: 1rem;
    resize: vertical;
    line-height: $ray-field-line-height;
    height: $ray-field-height - 2 * $ray-border-width;
  }

  &--compact {
    min-height: $ray-field-height-compact;
    line-height: 0;

    .#{$ray-class-prefix}text-area__input {
      padding-top: $ray-field-v-spacing-compact / 2;
      height: $ray-field-height-compact - 2 * $ray-border-width;
      min-height: $ray-field-height-compact - 2 * $ray-border-width;
    }
  }
}
