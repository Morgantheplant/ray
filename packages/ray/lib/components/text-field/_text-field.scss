@import '../../global/mixins/form-items';

.#{$prefix}text-field,
.#{$prefix}text-area {
  border: $border-width solid $ray-color-gray-60;
  background-color: $ray-color-white;
  border-radius: $border-radius;
  position: relative;
  height: $field-height;

  label,
  &__label {
    @include label;
    z-index: 2;
  }

  input,
  textarea,
  &__input {
    font-family: inherit;
    border-radius: $border-radius;
    line-height: 1;
    width: 100%;
    height: 100%;
    font-size: $field-label-size;
    display: block;
    background-color: transparent;
    padding: 0 $field-h-spacing;
    outline: 0;
    border: 0;
    cursor: pointer;

    &:focus,
    &:not(:placeholder-shown) {
      + label {
        @include label--active;
      }
    }

    &::placeholder {
      transition: color 0.125s ease-in;
      @include no-select;
    }

    &:not(:focus)::placeholder {
      color: transparent;
    }

    &:focus::placeholder,
    [placeholder] {
      text-overflow: ellipsis;
      color: $ray-color-text-medium;
    }
  }

  [placeholder] {
    text-overflow: ellipsis;
  }

  // :focus-within is only supported in modern browsers (https://caniuse.com/#search=focus-within), --active should be used as a backup
  &--active,
  &:focus-within {
    border-color: $ray-color-blue-50;

    label {
      @include label--active;
      color: $ray-color-blue-50;
    }

    input,
    textarea {
      &::placeholder {
        color: $ray-color-text-light !important;
      }
    }

    &.#{$prefix}text-field--compact,
    &.#{$prefix}text-area--compact {
      label {
        padding-top: 0;
      }
    }
  }

  &--disabled {
    border-color: rgba($ray-color-gray-60, 0.4);
  }

  &--success {
    border-color: $ray-color-green-70;
  }

  &--error {
    border-color: $ray-color-red-50;
  }

  [disabled] {
    background-color: $ray-color-white;
    @include no-select;

    &,
    + label {
      cursor: not-allowed;
      color: rgba($ray-color-gray-60, 0.4);
    }
  }

  &--compact {
    height: $field-height-compact;

    label,
    &__label {
      padding-top: $field-v-spacing-compact;
    }

    input,
    textarea,
    &__input {
      padding-top: 0;

      &:focus,
      &:not(:placeholder-shown) {
        + label {
          padding-top: 0;
          pointer-events: none;
        }
      }
    }
  }
}

.#{$prefix}text-area {
  line-height: 0;

  &,
  textarea {
    height: auto;
    min-height: $field-height - 2 * $border-width;
  }

  textarea {
    display: inline-block;
    padding-top: 1rem;
    resize: vertical;
    line-height: $field-line-height;
    height: $field-height - 2 * $border-width;
  }

  &--compact {
    min-height: $field-height-compact;
    line-height: 0;

    textarea {
      padding-top: $field-v-spacing-compact / 2;
      height: $field-height-compact - 2 * $border-width;
      min-height: $field-height-compact - 2 * $border-width;
    }
  }
}
